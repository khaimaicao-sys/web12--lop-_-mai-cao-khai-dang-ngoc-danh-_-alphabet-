<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/starfall-style.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />

    <title>ALPHABET Gallery</title>
  </head>
  <body>
    <h1>
      <marquee class="text-primary">Welcome to ALPHABET LEARNING</marquee>
    </h1>

    <!-- Letters grid: A–Z (each button now includes a data-video embed URL) -->
    <div class="letters-grid wrap">
      <button class="letter-btn" data-letter="A" data-img="https://placehold.co/300x200?text=Apple" data-caption="Apple" data-video="https://www.youtube.com/embed/gsb999VSvh8?si=AiThFQU1wKywnNQy">A</button>
      <button class="letter-btn" data-letter="B" data-img="https://placehold.co/300x200?text=Ball" data-caption="Ball" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">B</button>
      <button class="letter-btn" data-letter="C" data-img="https://placehold.co/300x200?text=Cat" data-caption="Cat" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">C</button>
      <button class="letter-btn" data-letter="D" data-img="https://placehold.co/300x200?text=Dog" data-caption="Dog" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">D</button>
      <button class="letter-btn" data-letter="E" data-img="https://placehold.co/300x200?text=Egg" data-caption="Egg" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">E</button>
      <button class="letter-btn" data-letter="F" data-img="https://placehold.co/300x200?text=Fish" data-caption="Fish" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">F</button>

      <button class="letter-btn" data-letter="G" data-img="https://placehold.co/300x200?text=Giraffe" data-caption="Giraffe" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">G</button>
      <button class="letter-btn" data-letter="H" data-img="https://placehold.co/300x200?text=Hat" data-caption="Hat" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">H</button>
      <button class="letter-btn" data-letter="I" data-img="https://placehold.co/300x200?text=Igloo" data-caption="Igloo" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">I</button>
      <button class="letter-btn" data-letter="J" data-img="https://placehold.co/300x200?text=Juice" data-caption="Juice" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">J</button>
      <button class="letter-btn" data-letter="K" data-img="https://placehold.co/300x200?text=Kite" data-caption="Kite" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">K</button>
      <button class="letter-btn" data-letter="L" data-img="https://placehold.co/300x200?text=Lion" data-caption="Lion" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">L</button>

      <button class="letter-btn" data-letter="M" data-img="https://placehold.co/300x200?text=Monkey" data-caption="Monkey" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">M</button>
      <button class="letter-btn" data-letter="N" data-img="https://placehold.co/300x200?text=Nest" data-caption="Nest" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">N</button>
      <button class="letter-btn" data-letter="O" data-img="https://placehold.co/300x200?text=Orange" data-caption="Orange" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">O</button>
      <button class="letter-btn" data-letter="P" data-img="https://placehold.co/300x200?text=Pig" data-caption="Pig" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">P</button>
      <button class="letter-btn" data-letter="Q" data-img="https://placehold.co/300x200?text=Queen" data-caption="Queen" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">Q</button>
      <button class="letter-btn" data-letter="R" data-img="https://placehold.co/300x200?text=Rabbit" data-caption="Rabbit" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">R</button>

      <button class="letter-btn" data-letter="S" data-img="https://placehold.co/300x200?text=Sun" data-caption="Sun" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">S</button>
      <button class="letter-btn" data-letter="T" data-img="https://placehold.co/300x200?text=Tiger" data-caption="Tiger" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">T</button>
      <button class="letter-btn" data-letter="U" data-img="https://placehold.co/300x200?text=Umbrella" data-caption="Umbrella" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">U</button>
      <button class="letter-btn" data-letter="V" data-img="https://placehold.co/300x200?text=Violin" data-caption="Violin" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">V</button>
      <button class="letter-btn" data-letter="W" data-img="https://placehold.co/300x200?text=Whale" data-caption="Whale" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">W</button>
      <button class="letter-btn" data-letter="X" data-img="https://placehold.co/300x200?text=Xylophone" data-caption="Xylophone" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">X</button>

      <button class="letter-btn" data-letter="Y" data-img="https://placehold.co/300x200?text=Yacht" data-caption="Yacht" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">Y</button>
      <button class="letter-btn" data-letter="Z" data-img="https://placehold.co/300x200?text=Zebra" data-caption="Zebra" data-video="https://www.youtube.com/embed/C7iIRpzM8Bg">Z</button>
    </div>

    <!-- Popup overlay for letter card -->
    <div id="popup-overlay" class="popup-overlay" style="display:none;">
      <div class="popup-card" role="dialog" aria-modal="true" aria-labelledby="popup-letter">
        <button class="popup-close" aria-label="Close">×</button>
        <div class="popup-content">
          <div class="popup-left text-center">
            <div id="popup-letter" class="letter bigmodal">A</div>
            <img class="popup-img" src="" alt="" />
            <p class="popup-caption"></p>
            <a class="popup-wiki btn btn-primary" href="#" target="_blank" rel="noopener">Learn on Wikipedia</a>
          </div>
          <div class="popup-right">
            <div class="popup-player">
              <img id="popup-thumb" class="popup-thumb" src="" alt="Video thumbnail" style="display:none; max-width:100%; border-radius:8px;" />
              <button id="popup-play" class="popup-play" aria-label="Play video" style="display:none;">▶</button>
              <div id="popup-iframe" class="popup-iframe"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer style="text-align:center;margin:18px 0">© 2025 - ABC Learn</footer>

    <script>
      (function(){
        const overlay = document.getElementById('popup-overlay');
        const card = overlay.querySelector('.popup-card');
        const popupThumb = document.getElementById('popup-thumb');
        const popupPlay = document.getElementById('popup-play');
        const popupIframeWrap = document.getElementById('popup-iframe');

        function getYoutubeId(url){
          if (!url) return null;
          // support embed URLs and short URLs
          const m = url.match(/(?:embed\/|v=|\/v\/|youtu\.be\/)([A-Za-z0-9_-]{11})/);
          return m ? m[1] : null;
        }

        function showPopup(letter, img, caption, video){
          overlay.style.display = 'flex';
          card.classList.remove('closing');
          void card.offsetWidth; // reflow
          card.classList.add('open');

          overlay.querySelector('#popup-letter').textContent = letter;
          const imgEl = overlay.querySelector('.popup-img');
          imgEl.src = img || '';
          imgEl.alt = caption || '';
          overlay.querySelector('.popup-caption').textContent = caption || '';
          overlay.querySelector('.popup-wiki').href = 'https://en.wikipedia.org/wiki/' + encodeURIComponent(caption || letter);

          // prepare thumbnail + play button instead of preloading iframe
          popupIframeWrap.innerHTML = '';
          const vidId = getYoutubeId(video);
          if (vidId){
            popupThumb.src = 'https://img.youtube.com/vi/' + vidId + '/hqdefault.jpg';
            popupThumb.style.display = '';
            popupPlay.style.display = 'inline-flex';
            popupPlay.dataset.embed = 'https://www.youtube.com/embed/' + vidId;
          } else {
            popupThumb.src = '';
            popupThumb.style.display = 'none';
            popupPlay.style.display = 'none';
            popupPlay.dataset.embed = '';
          }

          // focus for keyboard users
          overlay.querySelector('.popup-close').focus();
          document.body.style.overflow = 'hidden';
        }

        function hidePopup(){
          card.classList.remove('open');
          card.classList.add('closing');
          document.body.style.overflow = '';
          // clear iframe and reset thumbnail
          popupIframeWrap.innerHTML = '';
          popupThumb.style.display = '';
          popupPlay.style.display = 'inline-flex';
          setTimeout(()=>{
            overlay.style.display = 'none';
            card.classList.remove('closing');
          }, 300);
        }

        // play handler: create iframe on demand
        popupPlay.addEventListener('click', function(){
          const embed = this.dataset.embed;
          if (!embed) return;
          popupIframeWrap.innerHTML = '';
          const iframe = document.createElement('iframe');
          iframe.src = embed + '?rel=0&autoplay=1';
          iframe.title = 'Letter video';
          iframe.frameBorder = '0';
          iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
          iframe.allowFullscreen = true;
          iframe.style.width = '100%';
          iframe.style.height = '100%';
          popupIframeWrap.appendChild(iframe);
          popupThumb.style.display = 'none';
          this.style.display = 'none';
        });

        document.addEventListener('click', function(e){
          const btn = e.target.closest('.letter-btn');
          if (btn){
            showPopup(btn.dataset.letter, btn.dataset.img, btn.dataset.caption, btn.dataset.video);
          }
        });

        overlay.addEventListener('click', function(e){
          if (e.target === overlay) hidePopup();
        });

        overlay.querySelector('.popup-close').addEventListener('click', hidePopup);

        document.addEventListener('keydown', function(e){
          if (e.key === 'Escape' && overlay.style.display === 'flex') hidePopup();
        });
      })();
    </script>
  </body>
</html>